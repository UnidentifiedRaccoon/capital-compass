/**
 * –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –∏ –ª–æ–≥–∏–∫–∏ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
 */

import { createReportHtml } from '../src/pdf/markdownParser.js';

// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º (—Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è)
const minimalResponse = `üéØ **–¶–µ–ª—å:** —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –≤–∑–Ω–æ—Å –≤ –ü–î–° –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π –≤—ã–ø–ª–∞—Ç—ã –≤ —Ä–∞–∑–º–µ—Ä–µ 150 000 ‚ÇΩ –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é.

üì• **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –í–æ–∑—Ä–∞—Å—Ç: 23 –≥–æ–¥–∞
- –î–æ—Ö–æ–¥: 200 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –≤–∑–Ω–æ—Å: 50 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –¶–µ–ª—å: 150 000 ‚ÇΩ/–º–µ—Å
- –ù–∞—á–∞–ª–æ –≤—ã–ø–ª–∞—Ç: –ø–æ –æ–±—â–µ–º—É –ø—Ä–∞–≤–∏–ª—É

üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –¢—Ä–µ–±—É–µ–º—ã–π –≤–∑–Ω–æ—Å: 143 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –ü—Ä–æ–≥–Ω–æ–∑ –∫–∞–ø–∏—Ç–∞–ª–∞ –∫ –Ω–∞—á–∞–ª—É –≤—ã–ø–ª–∞—Ç: 11 115 000 ‚ÇΩ
- –û—Ü–µ–Ω–∫–∞ –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π –≤—ã–ø–ª–∞—Ç—ã –∏–∑ –∫–∞–ø–∏—Ç–∞–ª–∞ (—á–µ—Ä–µ–∑ 270 –º–µ—Å): 150 000 ‚ÇΩ
- –†–∞–∑–±–∏–≤–∫–∞ –ø—Ä–∏—Ç–æ–∫–∞:
  üí∞ –õ–∏—á–Ω—ã–µ –≤–∑–Ω–æ—Å—ã: 1 716 000 ‚ÇΩ –≤ –≥–æ–¥
  üèõÔ∏è –ì–æ—Å–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 858 000 ‚ÇΩ –≤ –≥–æ–¥
  üí∏ –ù–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç: 257 400 ‚ÇΩ –≤ –≥–æ–¥

üéõÔ∏è **–°—Ü–µ–Ω–∞—Ä–∏–∏:**
- –° —Ä–µ–∏–Ω–≤–µ—Å—Ç–æ–º –Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –≤—ã—á–µ—Ç–∞
- –ë–µ–∑ —Ä–µ–∏–Ω–≤–µ—Å—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –≤—ã—á–µ—Ç–∞

üí° **–ü–æ–¥—Å–∫–∞–∑–∫–∏:**
- –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –≤–∞—à –¥–æ—Ö–æ–¥.
- –ü–µ—Ä–µ–≤–æ–¥ –û–ü–° –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —Å–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏.

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è/—Ä–∏—Å–∫–∏:**
- –†–∞—Å—á—ë—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ 10%.
- –ì–æ—Ä–∏–∑–æ–Ω—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ –ø—Ä–∏ —Ä–∞–Ω–Ω–µ–º –Ω–∞—á–∞–ª–µ –≤—ã–ø–ª–∞—Ç.`;

// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º (–≤–∫–ª—é—á–∞—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è)
const fullResponse = `üéØ **–¶–µ–ª—å:** —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –≤–∑–Ω–æ—Å –≤ –ü–î–° –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π –≤—ã–ø–ª–∞—Ç—ã –≤ —Ä–∞–∑–º–µ—Ä–µ 200 000 ‚ÇΩ –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é.

üì• **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –í–æ–∑—Ä–∞—Å—Ç: 30 –ª–µ—Ç
- –ü–æ–ª: –∂–µ–Ω—Å–∫–∏–π
- –î–æ—Ö–æ–¥: 300 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª: 500 000 ‚ÇΩ
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –≤–∑–Ω–æ—Å: 100 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –¶–µ–ª—å: 200 000 ‚ÇΩ/–º–µ—Å
- –ù–∞—á–∞–ª–æ –≤—ã–ø–ª–∞—Ç: —á–µ—Ä–µ–∑ 25 –ª–µ—Ç
- –°—Ç–∞–≤–∫–∞ –ù–î–§–õ: 15%
- –†–µ–∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç: –Ω–µ—Ç

üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –¢—Ä–µ–±—É–µ–º—ã–π –≤–∑–Ω–æ—Å: 95 000 ‚ÇΩ –≤ –º–µ—Å—è—Ü
- –ü—Ä–æ–≥–Ω–æ–∑ –∫–∞–ø–∏—Ç–∞–ª–∞ –∫ –Ω–∞—á–∞–ª—É –≤—ã–ø–ª–∞—Ç: 15 200 000 ‚ÇΩ
- –û—Ü–µ–Ω–∫–∞ –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π –≤—ã–ø–ª–∞—Ç—ã –∏–∑ –∫–∞–ø–∏—Ç–∞–ª–∞ (—á–µ—Ä–µ–∑ 300 –º–µ—Å): 200 000 ‚ÇΩ
- –†–∞–∑–±–∏–≤–∫–∞ –ø—Ä–∏—Ç–æ–∫–∞:
  üí∞ –õ–∏—á–Ω—ã–µ –≤–∑–Ω–æ—Å—ã: 1 140 000 ‚ÇΩ –≤ –≥–æ–¥
  üèõÔ∏è –ì–æ—Å–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 570 000 ‚ÇΩ –≤ –≥–æ–¥
  üí∏ –ù–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç: 171 000 ‚ÇΩ –≤ –≥–æ–¥`;

async function testUpdatedPrompt() {
  console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏ –ª–æ–≥–∏–∫—É –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π...\n');

  try {
    // –¢–µ—Å—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    console.log('üìù –¢–µ—Å—Ç 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö');
    const minimalHtml = await createReportHtml(minimalResponse, '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç');
    console.log('‚úÖ HTML —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');
    console.log('üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π...');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ
    if (
      !minimalHtml.includes('–ü–æ–ª:') &&
      !minimalHtml.includes('–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª:') &&
      !minimalHtml.includes('–°—Ç–∞–≤–∫–∞ –ù–î–§–õ:')
    ) {
      console.log('‚úÖ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∫—Ä—ã—Ç—ã');
    } else {
      console.log('‚ùå –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
    }

    console.log('\nüìù –¢–µ—Å—Ç 2: –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö');
    const fullHtml = await createReportHtml(fullResponse, '–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç');
    console.log('‚úÖ HTML —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');
    console.log('üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π...');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
    if (
      fullHtml.includes('–∂–µ–Ω—Å–∫–∏–π') &&
      fullHtml.includes('500 000') &&
      fullHtml.includes('15%') &&
      fullHtml.includes('–ù–µ—Ç')
    ) {
      console.log('‚úÖ –í—Å–µ –ø–æ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
    } else {
      console.log('‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è');
      console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ HTML...');
      console.log('–°–æ–¥–µ—Ä–∂–∏—Ç "–∂–µ–Ω—Å–∫–∏–π":', fullHtml.includes('–∂–µ–Ω—Å–∫–∏–π'));
      console.log('–°–æ–¥–µ—Ä–∂–∏—Ç "500 000":', fullHtml.includes('500 000'));
      console.log('–°–æ–¥–µ—Ä–∂–∏—Ç "15%":', fullHtml.includes('15%'));
      console.log('–°–æ–¥–µ—Ä–∂–∏—Ç "–ù–µ—Ç":', fullHtml.includes('–ù–µ—Ç'));
    }

    console.log('\nüéâ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
    console.log('\nüìã –û–±–Ω–æ–≤–ª–µ–Ω–∏—è:');
    console.log('  ‚Ä¢ –ü—Ä–æ–º–ø—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è');
    console.log(
      '  ‚Ä¢ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: –ø–æ–ª "–Ω–µ —É–∫–∞–∑–∞–Ω", —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª 0, –ù–î–§–õ 13%, —Ä–µ–∏–Ω–≤–µ—Å—Ç "–¥–∞"'
    );
    console.log('  ‚Ä¢ –í —Ç–∞–±–ª–∏—Ü–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ–ª—è');
    console.log('  ‚Ä¢ –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö');
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:', error.message);
    throw error;
  }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
testUpdatedPrompt();
